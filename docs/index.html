<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
		<title>圣诞快乐</title>
		<link
			href="https://fonts.googleapis.com/css?family=Mountains+of+Christmas|Open+Sans+Condensed:700|Roboto:300,400|Source+Sans+Pro"
			rel="stylesheet" />
		<link href="https://fonts.googleapis.com/css?family=Dancing+Script:700" rel="stylesheet">
		<link rel="stylesheet" href="./style.css">
		<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
	</head>
	<body>
		<div id='audioPay'></div>
		<div class="card-container">
			<div class="snow-flakes-1"></div>
			<div class="snow-flakes-2"></div>
			<h1>Merry Christmas</h1>
			<div class="tree-container">
				<div class="ball-0"></div>
				<div class="tree-p1">
					<ul>
						<li>
							<div class="xmas-ball ball-1"></div>
							<div class="tree-left-branch"></div>
						</li>
						<li>
							<div class="tree-right-branch"></div>
						</li>
					</ul>
				</div>
				<div class="tree-p2">
					<ul>
						<li>
							<div class="xmas-ball ball-2"></div>
							<div class="tree-left-branch"></div>
						</li>
						<li>
							<div class="xmas-ball ball-3"></div>
							<div class="tree-right-branch"></div>
						</li>
					</ul>
				</div>
				<div class="tree-p3">
					<ul>
						<li>
							<div class="xmas-ball ball-6"></div>
							<div class="tree-left-branch"></div>
						</li>
						<li>
							<div class="xmas-ball ball-5"></div>
							<div class="xmas-ball ball-4"></div>
							<div class="tree-right-branch"></div>
						</li>
					</ul>
				</div>
				<div class="tree-p4">
					<ul>
						<li>
							<div class="xmas-ball ball-7"></div>
							<div class="xmas-ball ball-8"></div>
							<div class="tree-left-branch"></div>
						</li>
						<li>
							<div class="xmas-ball ball-9"></div>
							<div class="xmas-ball ball-10"></div>
							<div class="tree-right-branch stubborn"></div>
						</li>
					</ul>
				</div>
				<div class="wood"></div>
				<div class="presents">
					<div class="present-container-1">
						<div class="tie"></div>
						<div class="lid"></div>
						<div class="box"></div>
					</div>
					<div class="present-container-2">
						<div class="tie"></div>
						<div class="lid"></div>
						<div class="box"></div>
					</div>
				</div>
			</div>

			<div class="display">
				<h3>圣诞节快乐</h3>
			</div>

		</div>
		<!-- partial -->
	</body>
	<script>
		function IsPhone() {
			//获取浏览器navigator对象的userAgent属性（浏览器用于HTTP请求的用户代理头的值）
			var info = navigator.userAgent;
			//通过正则表达式的test方法判断是否包含“Mobile”字符串
			var isPhone = /mobile/i.test(info);
			//如果包含“Mobile”（是手机设备）则返回true
			console.log(info)
			return isPhone;
		}

		function play(src, type) {
			$("<embed id='embVoice' name='embed_" + type + "' src='" + src +
				"' autostart=true  hidden=true muted='muted'></embed>").appendTo("#audioPay");
			var interTimePay = setInterval(function() {
				try {
					var embedVoice = document.getElementById('embVoice');
					if (!embedVoice) {
						$("<embed id='embVoice' name='embed_" + type + "' src='" + src +
							"' autostart=true  hidden=true muted='muted'></embed>").appendTo("#audioPay");
					}
					setTimeout(function() {
						$('#embVoice').remove();
					}, 9000)
				} catch (e) {
					console.log("播放声音出现异常！", e);
				}
			}, 10000);
		}
		var src = "https://music.163.com/song/media/outer/url?id=21233912.mp3";
		var type = "type";
		play(src, type);
		var _audio
		var _isWeixinJSBridgeReady = false
		document.addEventListener('WeixinJSBridgeReady', () => {
		  _isWeixinJSBridgeReady = true
		  _audio = new Audio()
		  _audio.style.display = 'none'
		  // 播放空音频
		  _audio.src = 'ehttps://music.163.com/song/media/outer/url?id=21233912.mp3'
		  _audio.play()
		}, false)
		
		const initMusic = () => {
			var setInitMuisc = () => {
				// 播放背景音乐
				_audio.src = 'https://music.163.com/song/media/outer/url?id=21233912.mp3'
				_audio.play()
		
				document.removeEventListener('click', setInitMuisc)
				document.removeEventListener('touchstart', setInitMuisc)
		    }
			document.addEventListener('click', setInitMuisc)
		    document.addEventListener('touchstart', setInitMuisc)
		    document.body.click()
		}
		  
		const playMusic = () => {
			if (!_isWeixinJSBridgeReady && /MicroMessenger/.test(window.navigator.userAgent)) {
				document.addEventListener('WeixinJSBridgeReady', () => {
		        	initMusic()
				}, false)
		    } else {
				initMusic()
		    }
		}

		console.log(IsPhone())
		
	</script>
</html>
